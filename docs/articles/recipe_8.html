<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tadr">
<title>8. Dataset manipulation: tokenization and joining datasets • Text as Data Resources</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="8. Dataset manipulation: tokenization and joining datasets">
<meta property="og:description" content="tadr">
<meta property="og:image" content="https://lin380.github.io/tadr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-P69131XJC0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P69131XJC0');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Text as Data Resources</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../tutorials/index.html">Tutorials</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lin380/tadr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>8. Dataset manipulation: tokenization and joining datasets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lin380/tadr/blob/HEAD/vignettes/recipe_8.Rmd" class="external-link"><code>vignettes/recipe_8.Rmd</code></a></small>
      <div class="d-none name"><code>recipe_8.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>In this Recipe we will look at two primary types of transformations, tokenization and joins. Tokenization is the process of recasting textual units as smaller textual units. The process of joining datasets aims to incorporate other datasets to augment or filter the dataset of interest.</p>
<p>We will first look at a sample dataset to explore the strategies associated with tokenization and joins and then we will put these into practice with a more practical example.</p>
<p>Let’s load the packages that we will use for this Recipe.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># data manipulation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/juliasilge/tidytext" class="external-link">tidytext</a></span><span class="op">)</span>  <span class="co"># tokenization</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="coding-strategies">Coding strategies<a class="anchor" aria-label="anchor" href="#coding-strategies"></a>
</h3>
<p>To illustrate the relevant coding strategies I’ve created a curated dataset of the <a href="https://data.mendeley.com/datasets/fvtfjyvw7d/2" class="external-link">“Big Data Set from RateMyProfessor.com for Professors’ Teaching Evaluation”</a> <span class="citation">(<a href="#ref-He2020" role="doc-biblioref">He 2020</a>)</span>.</p>
<p>Let’s take a look at the curated dataset and get oriented to its structure.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"recipe_8/data/derived/rate_my_professor_sample/rmp_curated.csv"</span><span class="op">)</span>  <span class="co"># read curated dataset</span>

<span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">rmp</span><span class="op">)</span>  <span class="co"># preview structure</span></code></pre></div>
<pre><code><span class="co">## Rows: 10</span>
<span class="co">## Columns: 4</span>
<span class="co">## $ rating_id    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 89, 91, 5770, 3350, 1763, 4918, 2462, 982, 4734, 7903</span>
<span class="co">## $ online       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 1, 1, 1, 1, 1</span>
<span class="co">## $ student_star <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 5, 5, 5, 5, 5, 5, 1, 5, 1</span>
<span class="co">## $ comments     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "By far the most condescending, mean, disrespectful, and …</span></code></pre>
<p>We see that there are 10 observations and four columns.</p>
<p>There is a data dictionary associated with the <code>rmp</code> curated dataset. Let’s read it and show it in a human-readable format.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"recipe_8/data/derived/rate_my_professor_sample/rmp_curated_data_dictionary.csv"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># read data dictionary</span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span>,
               caption <span class="op">=</span> <span class="st">"Rate My Professor curated sample data dictionary."</span><span class="op">)</span> <span class="co"># show preview table</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:rmp-read-data-dictionary">Table 1: </span>Rate My Professor curated sample data dictionary.</caption>
<colgroup>
<col width="16%">
<col width="19%">
<col width="63%">
</colgroup>
<thead><tr class="header">
<th align="left">variable_name</th>
<th align="left">name</th>
<th align="left">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rating_id</td>
<td align="left">Rating ID</td>
<td align="left">Unique ID for each student course rating</td>
</tr>
<tr class="even">
<td align="left">online</td>
<td align="left">Online Course</td>
<td align="left">Was the course online or not: 1 is TRUE and 0 is FALSE</td>
</tr>
<tr class="odd">
<td align="left">student_star</td>
<td align="left">Student Rating</td>
<td align="left">Scalar rating provided by the student</td>
</tr>
<tr class="even">
<td align="left">comments</td>
<td align="left">Student Comments</td>
<td align="left">Student comments provided for the course</td>
</tr>
</tbody>
</table>
<p>Now let’s look a this small curated sample in its current form.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span>,
               caption <span class="op">=</span> <span class="st">"Rate My Professor curated sample preview."</span><span class="op">)</span> <span class="co"># show dataset preview</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:rmp-preview">Table 2: </span>Rate My Professor curated sample preview.</caption>
<colgroup>
<col width="2%">
<col width="1%">
<col width="3%">
<col width="92%">
</colgroup>
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">comments</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
</tr>
<tr class="odd">
<td align="right">5770</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">It's been “awhile” since law school…but, I thought Professor Frey was GREAT…he was my all time favorite law professor! He was always available…and willing to answer questions. He really cares about his students and wants them to succeed. Marty ROCKS!!!!!!!!!!!</td>
</tr>
<tr class="even">
<td align="right">3350</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Amazing professor! One of the few professors that has left an everylasting impression. I learned so much in his class. He makes everything interesting! However, the class does require a lot of assignments but you'll do them and not care. He is just that awesome. You have labs where you need to prepare teaches (intimidating) but it's a wonderful exp</td>
</tr>
<tr class="odd">
<td align="right">1763</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">outstanding. she may be tough but i think she helped me figure out why i wanted to teach phys ed.all you have to do is pay attention,speek upin class, pass the test and just show that you care about this major and you will be fine.she is tough but its to help you get ready for the real world</td>
</tr>
<tr class="even">
<td align="right">4918</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">This was one of the best courses I've ever taken. He puts so much effort into his lectures and assignments, you really learn everything inside and out. You must put in the effort and follow his requirements in the syllabus to do well. Waiting until the last day to do the assignments is not a good idea. Not an easy A, but highly recommend.</td>
</tr>
<tr class="odd">
<td align="right">2462</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">I took PSYCH 337 Comm. &amp; Society w/ Prof. Milburn (online). The material he provides is very interesting and I really enjoyed the class. He is extremely responsive if you ask him anything which is great. The class is very straight-forward and what is expected of you is laid out clearly. The work load is fair, &amp; if you do the work you will do well.</td>
</tr>
<tr class="even">
<td align="right">982</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Would not recommend anyone to take his online course. According to Hassan, “As far as I know, this course has never Audio or Vedio lectures because they are not developed by the departmentschool. So, we have to read the text book and then post any questions on any concept or methods here,and I will address it.” TA worked pretty hard.</td>
</tr>
<tr class="odd">
<td align="right">4734</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">Let me start by saying this is not an easy class. You will have tons of homework to do each week. That being said I think almost all Algebra classes have the same work. Mr. G is a good guy and wants people to pass. If you do the homework and study his review you will be fine. May not get an A, but you will pass. I would recommend him</td>
</tr>
<tr class="even">
<td align="right">7903</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">Never actually explains what he wants. He will fail your assignments and not give clear feedback as to what he actually expects from you. Quiz, 2 journals, and groupwork due each week. Rude and extremely unhelpful.</td>
</tr>
</tbody>
</table>
<p>From this orientation to the dataset we can see that there are four columns <code>id</code>, <code>online</code>, <code>student_star</code>, and <code>comments</code>. The first three are metadata associated with the text in <code>comments</code>. We also see that the <code>online</code> column contains five positive comments and five negative comments.</p>
<div class="section level4">
<h4 id="tokenization">Tokenization<a class="anchor" aria-label="anchor" href="#tokenization"></a>
</h4>
<p>The very helpful function <code><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens()</a></code> from the tidytext package is the most efficient way to recast a column with text into various smaller textual units –all while maintaining the metadata structure from the curated dataset. In this way, our transformation will maintain a tidy data format.</p>
<p>Let’s consider some of the key options for tokenization that are provided through the <code><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens()</a></code> function. First let’s look at the arguments using the <code><a href="https://rdrr.io/r/base/args.html" class="external-link">args()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/args.html" class="external-link">args</a></span><span class="op">(</span><span class="va">unnest_tokens</span><span class="op">)</span>  <span class="co"># view the arguments</span></code></pre></div>
<pre><code><span class="co">## function (tbl, output, input, token = "words", format = c("text", </span>
<span class="co">##     "man", "latex", "html", "xml"), to_lower = TRUE, drop = TRUE, </span>
<span class="co">##     collapse = NULL, ...) </span>
<span class="co">## NULL</span></code></pre>
<p>In order of appearance in the function, the <code>tbl</code> argument takes a data frame, the <code>output</code> will be a character vector with the desired name of the output column after tokenization, the <code>input</code> is the character vector which names the column which contains the textual information to be tokenized, the <code>token</code> argument is where we specify what type of token we would like to generate from the <code>input</code> column, the <code>format</code> argument is often left as the default ‘text’ –as we most often that not are working with text, the <code>drop</code> argument by default with drop the <code>input</code> column in the tokenized dataset, the <code>to_lower</code> argument let’s us decide if we want to lowercase the text when it is tokenized, the <code>collapse</code> argument allows for grouping the tokenization output and is often left to ‘NULL’ (the default), and finally we have a <code>...</code> argument which leaves the possibility of adding arguments that are relevant for some of the token options, specifically for ‘ngrams’ and ‘character_shingles’.</p>
<p>Let’s see <code><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens()</a></code> in action starting first with the most common tokenization unit (and therefore the default) ‘words’.</p>
<div class="section level5">
<h5 id="words">Words<a class="anchor" aria-label="anchor" href="#words"></a>
</h5>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># input column to tokenize</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview first 10 observations</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">by</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">far</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">the</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">most</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">condescending</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">mean</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">disrespectful</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">and</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">downright</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">rude</td>
</tr>
</tbody>
</table>
</div>
<p>We now see from this preview of the first 10 observations that we have words from the comments tokenized. <code><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens()</a></code> will return each of these tokens on their own row and maintain the metadata from the original dataset (dropping the input <code>comments</code> column). We also see that by default that the tokens have been lowercased, again, this is the default behavior.</p>
<p>Let’s change the <code>drop =</code> argument and the <code>to_lower =</code> argument from their defaults (<code>TRUE</code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span>, <span class="co"># input column to tokenize</span>
                to_lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># do not lowercase</span>
                drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># do not drop input column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview first 10 observations</span></code></pre></div>
<div class="kable-table">
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="1%">
<col width="3%">
<col width="88%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">comments</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">By</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">far</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">the</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">most</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">condescending</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">mean</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">disrespectful</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">and</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">downright</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">rude</td>
</tr>
</tbody>
</table>
</div>
<p>Note that if the textual input has punctuation, the <code><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens()</a></code> function will strip this punctuation when doing the tokenization for words.</p>
</div>
<div class="section level5">
<h5 id="sentences">Sentences<a class="anchor" aria-label="anchor" href="#sentences"></a>
</h5>
<p>If we specify that the tokenized unit is <code>sentences</code>, then the punctuation is not stripped.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"sentence"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span>, <span class="co"># input column to tokenize</span>
                token <span class="op">=</span> <span class="st">"sentences"</span>, <span class="co"># tokenize to sentences</span>
                to_lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># do not lowercase</span>
                drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># do not drop input column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview first 10 observations</span></code></pre></div>
<div class="kable-table">
<table class="table">
<colgroup>
<col width="2%">
<col width="1%">
<col width="2%">
<col width="71%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">comments</th>
<th align="left">sentence</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever.</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Of all the classes I have taken in my college career, this was the absolute worst.</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Very unclear instructions not to mention ridiculous amounts of outdated readings required.</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Do yourself a favor and do not take any classes by her.</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">You will regret it.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">Dr.</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">White is by far the best teacher I've had at UT.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">If you come to class and pay attention, she will be incredibly helpful, especially in office hours.</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">Overall, she's helpful, to the point, and knows her stuff.</td>
</tr>
</tbody>
</table>
</div>
<p>If we take a close look at the output of using sentence tokens in this case we see that there are multiple sentences in the same observation row. This appears to be due to the fact that students sometimes opted not to capitalize the beginning of the next sentence. This suggests that the algorithm that <code><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens()</a></code> uses sentences punctuation followed by a capitalized word to segment/ tokenize sentences.</p>
<div class="tip">
<p>It is important to review the output of the tokenization to catch these types of anomalies and not assume that the algorithm will be perfectly accurate.</p>
</div>
<p>If the tokenization defaults (<code>words</code>, <code>sentences</code>, etc.) do not produce the desired result, we can specify the <code>token =</code> argument to <code>regex</code>. This allows us to specify a regular expression pattern to do the tokenization in the added argument <code>pattern =</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"sentence"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span>, <span class="co"># input column to tokenize</span>
                token <span class="op">=</span> <span class="st">"regex"</span>, <span class="co"># tokenize by a regex pattern</span>
                pattern <span class="op">=</span> <span class="st">"[.!?]\\s"</span>,
                to_lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># do not lowercase</span>
                drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># do not drop input column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview first 10 observations</span></code></pre></div>
<div class="kable-table">
<table class="table">
<colgroup>
<col width="2%">
<col width="1%">
<col width="2%">
<col width="71%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">comments</th>
<th align="left">sentence</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Of all the classes I have taken in my college career, this was the absolute worst</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Very unclear instructions not to mention ridiculous amounts of outdated readings required</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Do yourself a favor and do not take any classes by her</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">You will regret it.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">Dr</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">White is by far the best teacher I've had at UT</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">If you come to class and pay attention, she will be incredibly helpful, especially in office hours</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">Overall, she's helpful, to the point, and knows her stuff</td>
</tr>
</tbody>
</table>
</div>
<p>Note that when a pattern used to segment the text is matched, the match is removed. We can use some regular expression magic with the ‘positive lookbehind’ operator <code>(?&lt;=)</code> to detect a pattern, but not use it as a match. In this case if we apply this to the punctuation part of our original regex, we can preserve the sentence punctuation and still segment the sentences.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"sentence"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span>, <span class="co"># input column to tokenize</span>
                token <span class="op">=</span> <span class="st">"regex"</span>, <span class="co"># tokenize by a regex pattern</span>
                pattern <span class="op">=</span> <span class="st">"(?&lt;=[.!?])\\s"</span>,
                to_lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># do not lowercase</span>
                drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># do not drop input column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview first 10 observations</span></code></pre></div>
<div class="kable-table">
<table class="table">
<colgroup>
<col width="2%">
<col width="1%">
<col width="2%">
<col width="71%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">comments</th>
<th align="left">sentence</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever.</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Of all the classes I have taken in my college career, this was the absolute worst.</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Very unclear instructions not to mention ridiculous amounts of outdated readings required.</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">Do yourself a favor and do not take any classes by her.</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">You will regret it.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">Dr.</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">White is by far the best teacher I've had at UT.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">If you come to class and pay attention, she will be incredibly helpful, especially in office hours.</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class.</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">Dr. White is by far the best teacher I've had at UT. If you come to class and pay attention, she will be incredibly helpful, especially in office hours. She gives pop quizzes but also gives at least 3 opportunities to replace a bad quiz grade if you come to class. Overall, she's helpful, to the point, and knows her stuff. Take this class for sure</td>
<td align="left">Overall, she's helpful, to the point, and knows her stuff.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level5">
<h5 id="ngrams">Ngrams<a class="anchor" aria-label="anchor" href="#ngrams"></a>
</h5>
<p>Now let’s turn to <code>ngram</code> tokenization. An ngram is a sequence of words where <span class="math inline">\(n\)</span> is the sequence desired in the output. Word tokenization is sometimes called a unigram. To get ngrams larger than one word, we use the specify <code>token =</code> to <code>ngrams</code>. Then we need to add the argument <code>n =</code> and set the number of word sequences we want to tokenize. <code>n = 2</code> would produce bigrams, <code>n = 3</code> trigrams, and so on.</p>
<p>So let’s see this in action by creating bigrams.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"bigram"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span>, <span class="co"># input column to tokenize</span>
                token <span class="op">=</span> <span class="st">"ngrams"</span>, <span class="co"># tokenize ngram sequences</span>
                n <span class="op">=</span> <span class="fl">2</span>, <span class="co"># two word sequences</span>
                to_lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># do not lowercase</span>
                drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># do not drop input column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview first 10 observations</span></code></pre></div>
<div class="kable-table">
<table class="table">
<colgroup>
<col width="2%">
<col width="1%">
<col width="3%">
<col width="87%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">comments</th>
<th align="left">bigram</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">By far</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">far the</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">the most</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">most condescending</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">condescending mean</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">mean disrespectful</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">disrespectful and</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">and downright</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">downright rude</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">By far the most condescending, mean, disrespectful, and downright rude professor ever. Of all the classes I have taken in my college career, this was the absolute worst. Very unclear instructions not to mention ridiculous amounts of outdated readings required. Do yourself a favor and do not take any classes by her. You will regret it.</td>
<td align="left">rude professor</td>
</tr>
</tbody>
</table>
</div>
<p>Great. We now have two word sequences (bigrams) as our tokens. But if we look at the ouput we see that the tokenization of bigrams included sequences that span between sentences (ex. ‘teacher wouldnt’. This is due to the fact that we used the original input (<code>comments</code>) which has all the text. In some cases we may not want to capture these cross-sentential word sequences. To avoid this we can first tokenize our <code>comments</code> by sentences (with the regular expression approach), then pass this result to our bigram tokenization.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="co"># Tokenize by sentences</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"sentence"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span>, <span class="co"># input column to tokenize</span>
                token <span class="op">=</span> <span class="st">"regex"</span>, <span class="co"># tokenize by a regex pattern</span>
                pattern <span class="op">=</span> <span class="st">"(?&lt;=[.!?])\\s"</span>,
                to_lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># do not lowercase</span>
  <span class="co"># Add a sentence_id to the dataset</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">rating_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># group the comments</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sentence_id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># add a sentence id to index the individual sentences for each comment </span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># remove grouping attribute</span>
  <span class="co"># Tokenize the sentences by bigrams</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"bigram"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"sentence"</span>, <span class="co"># input column to tokenize</span>
                token <span class="op">=</span> <span class="st">"ngrams"</span>, <span class="co"># tokenize by ngrams</span>
                n <span class="op">=</span> <span class="fl">2</span>, <span class="co"># create bigrams</span>
                to_lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># do not lowercase</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview first 10 observations</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="right">sentence_id</th>
<th align="left">bigram</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">By far</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">far the</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">the most</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">most condescending</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">condescending mean</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">mean disrespectful</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">disrespectful and</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">and downright</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">downright rude</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">rude professor</td>
</tr>
</tbody>
</table>
</div>
<p>So by applying firs the sentence tokenization and then the ngram tokenization we avoid cross-sentential word sequences.</p>
<div class="tip">
<p>Note that I added a <code>sentence_id</code> column to make sure that the sentence from which the bigram comes is documented in the dataset.</p>
</div>
<p>With this overview of the options and strategies for tokenizing textual input, I will now create a word-based tokenization of the <code>rmp</code> dataset, lowercasing the text in preparation for our next strategy to cover, joins.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp_words</span> <span class="op">&lt;-</span> 
  <span class="va">rmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># tokenized output column</span>
                input <span class="op">=</span> <span class="st">"comments"</span><span class="op">)</span> <span class="co"># input column to tokenize</span>

<span class="va">rmp_words</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>booktabs <span class="op">=</span> <span class="cn">TRUE</span>, 
               caption <span class="op">=</span> <span class="st">"Preview of the `rmp_words` dataset."</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:rmp-word-tokens-example">Table 3: </span>Preview of the <code>rmp_words</code> dataset.</caption>
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">by</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">far</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">the</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">most</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">condescending</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">mean</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">disrespectful</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">and</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">downright</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">rude</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level4">
<h4 id="joining-datasets">Joining datasets<a class="anchor" aria-label="anchor" href="#joining-datasets"></a>
</h4>
<p>The dplyr package, loaded as part of the tidyverse, contains a number of functions aimed at joining datasets. These functions are of two main types: mutating joins and filtering joins.</p>
<p>In both cases a join relates two datasets that share a column (or column) which has overlapping values. For mutating joins, the shared column/s is/are the key that connects the two datasets and effectively expands the columns combining the columns from each dataset where the values match across both datasets. For filtering joins, the shared column effectively is used to filter rows in a dataset that have matching values in both datasets. Filter may be used to exclude matching values, or only include those values that match. Let’s look a these two types of joins to get a better sense of their behavior.</p>
<div class="section level5">
<h5 id="mutating-joins">Mutating joins<a class="anchor" aria-label="anchor" href="#mutating-joins"></a>
</h5>
<p>As a demonstration, let’s consider a dataset included in the tidytext package which provides a list of words and a sentiment value for each word.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sentiment</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">word</th>
<th align="left">sentiment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2-faces</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="left">abnormal</td>
<td align="left">negative</td>
</tr>
<tr class="odd">
<td align="left">abolish</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="left">abominable</td>
<td align="left">negative</td>
</tr>
<tr class="odd">
<td align="left">abominably</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="left">abound</td>
<td align="left">positive</td>
</tr>
<tr class="odd">
<td align="left">abounds</td>
<td align="left">positive</td>
</tr>
<tr class="even">
<td align="left">abundance</td>
<td align="left">positive</td>
</tr>
<tr class="odd">
<td align="left">abundant</td>
<td align="left">positive</td>
</tr>
<tr class="even">
<td align="left">accessable</td>
<td align="left">positive</td>
</tr>
</tbody>
</table>
</div>
<p>We can see that the <code><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments()</a></code> function returns a dataset with two columns (<code>word</code> and <code>sentiment</code>). I’ve only provided the first five word-sentiment pairs for ‘negative’ and ‘positive’ sentiments. However, the full dataset contains 6786 words.</p>
<p>We can see how many are listed as positive and negative.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sentiment</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">sentiment</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">negative</td>
<td align="right">4781</td>
</tr>
<tr class="even">
<td align="left">positive</td>
<td align="right">2005</td>
</tr>
</tbody>
</table>
</div>
<p>We can see that negative words outnumber the positive-labeled words.</p>
<p>With this information, we can now see that our <code>rmp_words</code> dataset and the dataset from <code><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments()</a></code> share a column called <code>word</code>. More importantly, the columns share the same type of values, i.e. words. If we wanted to augment our <code>rmp_words</code> dataset with the sentiment labels from <code><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments()</a></code> we will want to use a mutating join. The idea will be to create a data frame with the following structure:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">rating_id</span>, <span class="op">~</span><span class="va">online</span>, <span class="op">~</span><span class="va">student_star</span>, <span class="op">~</span><span class="va">word</span>, <span class="op">~</span><span class="va">sentiment</span>,
  <span class="fl">84</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="st">"good"</span>, <span class="st">"positive"</span>,
  <span class="fl">84</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="st">"teacher"</span>, <span class="cn">NA</span>,
  <span class="fl">2802</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="st">"worst"</span>, <span class="st">"negative"</span>,
  <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"..."</span>, <span class="st">"..."</span>
<span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
<th align="left">sentiment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">84</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">good</td>
<td align="left">positive</td>
</tr>
<tr class="even">
<td align="right">84</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">teacher</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">2802</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">worst</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">…</td>
<td align="left">…</td>
</tr>
</tbody>
</table>
</div>
<p>In this structure we want all of the observations (words) from <code>rmp_words</code> to appear and those words with matches in <code><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments()</a></code> should also get a corresponding sentiment value. To do this we use the <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> function. This function takes to primary arguments <code>x</code> and <code>y</code> where <code>x</code> is the dataset which we want all of the observations to be included and <code>y</code> where the matching values will also get the corresponding values.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">rmp_words</span>, <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
<th align="left">sentiment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">by</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">far</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">the</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">most</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">condescending</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">mean</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">disrespectful</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">and</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">downright</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">rude</td>
<td align="left">negative</td>
</tr>
</tbody>
</table>
</div>
<p>Note that <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> keeps all of the rows from the <code>x</code> dataset –in this case <code>rmp_words</code>. If, for example, we wanted to do a mutating join and remove words from <code>x</code> that do not have a match in <code>y</code>, then we can turn to <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">rmp_words</span>, <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html" class="external-link">get_sentiments</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
<th align="left">sentiment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">condescending</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">disrespectful</td>
<td align="left">negative</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">rude</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">worst</td>
<td align="left">negative</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">unclear</td>
<td align="left">negative</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">ridiculous</td>
<td align="left">negative</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">favor</td>
<td align="left">positive</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">regret</td>
<td align="left">negative</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">best</td>
<td align="left">positive</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">incredibly</td>
<td align="left">positive</td>
</tr>
</tbody>
</table>
</div>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join()</a></code> is in essence a mutating join with a filtering side effect. If we want to simply filter a dataset based on the values in other dataset, we turn to the filtering joins.</p>
</div>
<div class="section level5">
<h5 id="filtering-joins">Filtering joins<a class="anchor" aria-label="anchor" href="#filtering-joins"></a>
</h5>
<p>To look at filtering joins let’s consider another dataset also included with the tidytext package <code><a href="https://rdrr.io/pkg/tidytext/man/get_stopwords.html" class="external-link">get_stopwords()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_stopwords.html" class="external-link">get_stopwords</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">word</th>
<th align="left">lexicon</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">i</td>
<td align="left">snowball</td>
</tr>
<tr class="even">
<td align="left">me</td>
<td align="left">snowball</td>
</tr>
<tr class="odd">
<td align="left">my</td>
<td align="left">snowball</td>
</tr>
<tr class="even">
<td align="left">myself</td>
<td align="left">snowball</td>
</tr>
<tr class="odd">
<td align="left">we</td>
<td align="left">snowball</td>
</tr>
<tr class="even">
<td align="left">our</td>
<td align="left">snowball</td>
</tr>
<tr class="odd">
<td align="left">ours</td>
<td align="left">snowball</td>
</tr>
<tr class="even">
<td align="left">ourselves</td>
<td align="left">snowball</td>
</tr>
<tr class="odd">
<td align="left">you</td>
<td align="left">snowball</td>
</tr>
<tr class="even">
<td align="left">your</td>
<td align="left">snowball</td>
</tr>
</tbody>
</table>
</div>
<p>Stopwords are words that are considered to have little semantic content (they roughly correspond to pronouns, prepositions, conjunctions, etc.). In some research cases we will want to remove these words from a dataset. To remove these words we can use the filtering join called <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join()</a></code>, which you can imagine will return all the rows in <code>x</code> that do not have a match in <code>y</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join</a></span><span class="op">(</span><span class="va">rmp_words</span>, <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_stopwords.html" class="external-link">get_stopwords</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">far</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">condescending</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">mean</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">disrespectful</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">downright</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">rude</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">professor</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">ever</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">classes</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">taken</td>
</tr>
</tbody>
</table>
</div>
<p>We see now that the stopwords have been removed from the <code>rmp_words</code> dataset.</p>
<p>Now if we want to the the inverse operation, keeping the stopwords in <code>rmp_words</code> we can use the <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join()</a></code> function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">rmp_words</span>, <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_stopwords.html" class="external-link">get_stopwords</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">by</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">the</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">most</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">and</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">of</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">all</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">the</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">i</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">have</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">in</td>
</tr>
</tbody>
</table>
</div>
<p>One last case that is worth including here has to do with a filtering join which takes a character vector, not a data frame. The <code>%in%</code> operator can be used as a <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join()</a></code> keeping matching values in <code>x</code> or as an <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join()</a></code> removing values in <code>x</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp_words</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">word</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"very"</span>, <span class="st">"teacher"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># keep matching rows</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">very</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="left">teacher</td>
</tr>
<tr class="odd">
<td align="right">2462</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">very</td>
</tr>
<tr class="even">
<td align="right">2462</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">very</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmp_words</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">word</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"very"</span>, <span class="st">"teacher"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># remove matching rows</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">rating_id</th>
<th align="right">online</th>
<th align="right">student_star</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">by</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">far</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">the</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">most</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">condescending</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">mean</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">disrespectful</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">and</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">downright</td>
</tr>
<tr class="even">
<td align="right">89</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">rude</td>
</tr>
</tbody>
</table>
</div>
<p>Note that in all filtering joins, no new columns are added, only rows are affected.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="case">Case<a class="anchor" aria-label="anchor" href="#case"></a>
</h3>
<p>Let’s now turn to a practical case and see tokenization and joins in action. I will work with the Love On The Spectrum curated dataset that we have previously worked with.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read the curated dataset for Love on the Spectrum Season 1</span>
<span class="va">lots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"recipe_8/data/derived/love_on_the_spectrum/lots_curated.csv"</span><span class="op">)</span>

<span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">lots</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Rows: 3</span>
<span class="co">## Columns: 4</span>
<span class="co">## $ series   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Love On The Spectrum", "Love On The Spectrum", "Love On The …</span>
<span class="co">## $ season   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "01", "01", "01"</span>
<span class="co">## $ episode  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "01", "02", "03"</span>
<span class="co">## $ dialogue <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "It'll be like a fairy tale. A natural high, I suppose? Gets …</span></code></pre>
<p>The aim will be to tokenize the dataset by words and then join an imported dataset which contains word frequencies calculated on a corpus of TV/Film transcripts, <a href="https://www.ugent.be/pp/experimentele-psychologie/en/research/documents/subtlexus" class="external-link">SUBTLEXus word frequencies</a>. I’ll read in this dataset and clean up the columns so that we only have the relevant columns for our transformational goals.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word_frequencies</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"recipe_8/data/original/word_frequency_list/SUBTLEXus.tsv"</span><span class="op">)</span>

<span class="va">word_frequencies</span> <span class="op">&lt;-</span> 
  <span class="va">word_frequencies</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">word</span>, word_freq <span class="op">=</span> <span class="va">SUBTLWF</span><span class="op">)</span> <span class="co"># select columns</span>

<span class="va">word_frequencies</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">word</th>
<th align="right">word_freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">the</td>
<td align="right">29449</td>
</tr>
<tr class="even">
<td align="left">to</td>
<td align="right">22678</td>
</tr>
<tr class="odd">
<td align="left">a</td>
<td align="right">20415</td>
</tr>
<tr class="even">
<td align="left">you</td>
<td align="right">41857</td>
</tr>
<tr class="odd">
<td align="left">and</td>
<td align="right">13388</td>
</tr>
<tr class="even">
<td align="left">it</td>
<td align="right">18896</td>
</tr>
<tr class="odd">
<td align="left">s</td>
<td align="right">20731</td>
</tr>
<tr class="even">
<td align="left">of</td>
<td align="right">11577</td>
</tr>
<tr class="odd">
<td align="left">for</td>
<td align="right">6895</td>
</tr>
<tr class="even">
<td align="left">I</td>
<td align="right">39971</td>
</tr>
</tbody>
</table>
</div>
<p>The result of this transformation aims to produce the following dataset structure:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">series</span>, <span class="op">~</span><span class="va">season</span>, <span class="op">~</span><span class="va">episode</span>, <span class="op">~</span><span class="va">word</span>, <span class="op">~</span><span class="va">word_freq</span>,
  <span class="st">"Love On The Spectrum"</span>, <span class="st">"01"</span>, <span class="st">"01"</span>, <span class="st">"it"</span>, <span class="fl">18896</span>
<span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">series</th>
<th align="left">season</th>
<th align="left">episode</th>
<th align="left">word</th>
<th align="right">word_freq</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">it</td>
<td align="right">18896</td>
</tr></tbody>
</table>
</div>
<div class="section level4">
<h4 id="tokenize">Tokenize<a class="anchor" aria-label="anchor" href="#tokenize"></a>
</h4>
<p>The first step is to tokenize the <code>lots</code> curated dataset into word tokens.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tokenize dialogue into words</span>
<span class="va">lots_words</span> <span class="op">&lt;-</span> 
  <span class="va">lots</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># output column</span>
                input <span class="op">=</span> <span class="st">"dialogue"</span>, <span class="co"># input column</span>
                token <span class="op">=</span> <span class="st">"words"</span><span class="op">)</span> <span class="co"># tokenized unit</span>

<span class="va">lots_words</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">series</th>
<th align="left">season</th>
<th align="left">episode</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">it’ll</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">be</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">like</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">fairy</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">tale</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">natural</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">high</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">i</td>
</tr>
</tbody>
</table>
</div>
<p>One thing I notice from this preview is that words like “it’ll” are considered one token, not two (i.e. ‘it’ and ‘ll’). Let’s use <code>%in%</code> to filter (i.e. search) the <code>word_frequencies</code> dataset to see if words like “it’ll” are listed.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">word_frequencies</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">word</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"it'll"</span>, <span class="st">"it"</span>, <span class="st">"ll"</span><span class="op">)</span><span class="op">)</span> <span class="co">#search for it'll, it, and ll</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">word</th>
<th align="right">word_freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">it</td>
<td align="right">18896</td>
</tr>
<tr class="even">
<td align="left">ll</td>
<td align="right">4394</td>
</tr>
</tbody>
</table>
</div>
<p>It appears that ‘it’ and ‘ll’ are treated as separate words. Therefore we want to make sure that our tokenization of the <code>lots</code> dataset reflects this too. Our original tokenization using the default <code>token = "words"</code> did not do this so let’s create a regular expression to do this.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lots</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># output column</span>
                input <span class="op">=</span> <span class="st">"dialogue"</span>, <span class="co"># input column</span>
                token <span class="op">=</span> <span class="st">"regex"</span>, <span class="co"># regex tokenization</span>
                pattern <span class="op">=</span> <span class="st">"(\\s|')"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># regex pattern</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">series</th>
<th align="left">season</th>
<th align="left">episode</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">it</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">ll</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">be</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">like</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">fairy</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">tale.</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">natural</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">high,</td>
</tr>
</tbody>
</table>
</div>
<p>This works, but there is a side effect –namely that the punctuation has not been stripped. To get rid of the punctuation we can normalize the <code>word</code> column, removing punctuation.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lots</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># output column</span>
                input <span class="op">=</span> <span class="st">"dialogue"</span>, <span class="co"># input column</span>
                token <span class="op">=</span> <span class="st">"regex"</span>, <span class="co"># regex tokenization</span>
                pattern <span class="op">=</span> <span class="st">"(\\s|')"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># regex pattern</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>word <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">word</span>, pattern <span class="op">=</span> <span class="st">"[:punct:]"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># remove punctuation</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># preview</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">series</th>
<th align="left">season</th>
<th align="left">episode</th>
<th align="left">word</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">it</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">ll</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">be</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">like</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">fairy</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">tale</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">natural</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">high</td>
</tr>
</tbody>
</table>
</div>
<p>This appears to look good. Let’s now assign this ouput to an object so we can move to join this dataset with the <code>word_frequencies</code> dataset.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lots_words</span> <span class="op">&lt;-</span> 
  <span class="va">lots</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># dataset</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span>output <span class="op">=</span> <span class="st">"word"</span>, <span class="co"># output column</span>
                input <span class="op">=</span> <span class="st">"dialogue"</span>, <span class="co"># input column</span>
                token <span class="op">=</span> <span class="st">"regex"</span>, <span class="co"># regex tokenization</span>
                pattern <span class="op">=</span> <span class="st">"(\\s|')"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># regex pattern</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>word <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">word</span>, pattern <span class="op">=</span> <span class="st">"[:punct:]"</span><span class="op">)</span><span class="op">)</span> <span class="co"># remove punctuation</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="join">Join<a class="anchor" aria-label="anchor" href="#join"></a>
</h4>
<p>Now it is time to join the <code>lots_words</code> and the <code>word_frequencies</code> keeping all the observations in <code>x</code> and adding the <code>word_freq</code> column for words that match in <code>x</code> and <code>y</code>. So we will turn to the function <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">lots_words</span>, <span class="va">word_frequencies</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">series</th>
<th align="left">season</th>
<th align="left">episode</th>
<th align="left">word</th>
<th align="right">word_freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">it</td>
<td align="right">18896.3</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">ll</td>
<td align="right">4394.1</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">be</td>
<td align="right">5746.8</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">like</td>
<td align="right">3999.0</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
<td align="right">20415.3</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">fairy</td>
<td align="right">16.7</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">tale</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">a</td>
<td align="right">20415.3</td>
</tr>
<tr class="odd">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">natural</td>
<td align="right">42.4</td>
</tr>
<tr class="even">
<td align="left">Love On The Spectrum</td>
<td align="left">01</td>
<td align="left">01</td>
<td align="left">high</td>
<td align="right">195.0</td>
</tr>
</tbody>
</table>
</div>
<p>This looks good so let’s assign this operation to a new object <code>lots_words_freq</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lots_words_freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">lots_words</span>, <span class="va">word_frequencies</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="document">Document<a class="anchor" aria-label="anchor" href="#document"></a>
</h4>
<p>The final step in the process is to write the transformed dataset to disk and document it with a data dictionary.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">lots_words_freq</span>, file <span class="op">=</span> <span class="st">"recipe_8/data/derived/love_on_the_spectrum/lots_words_freq.csv"</span><span class="op">)</span></code></pre></div>
<p>Using our <code>data_dic_starter()</code> we can create the data dictionary template that we can then open in a spreadsheet and document.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">data_dic_starter</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lots_words_freq</span>, file_path <span class="op">=</span> <span class="st">"recipe_8/data/derived/love_on_the_spectrum/lots_words_freq_data_dictionary.csv"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-He2020" class="csl-entry">
He, Jibo. 2020. <span>“Big Data Set from RateMyProfessor.com for Professors’ Teaching Evaluation”</span> 2 (March). <a href="https://doi.org/10.17632/fvtfjyvw7d.2" class="external-link">https://doi.org/10.17632/fvtfjyvw7d.2</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jerid Francom.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
